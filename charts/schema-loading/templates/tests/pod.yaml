apiVersion: v1
kind: Pod
metadata:
  namespace: {{ .Release.Namespace }}
  name: "{{ include "schema-loading.fullname" . }}-test-kubectl"
  labels:
    {{- include "schema-loading.selectorLabels" . | nindent 4 }}
  annotations:
    "helm.sh/hook": test
spec:
  serviceAccountName: {{ include "schema-loading.fullname" . }}-test-kubectl-sa
  automountServiceAccountToken: true
  containers:
    - name: kubectl
      image: bitnami/kubectl:{{ .Values.test.kubectlImageTag }}
      command: ['kubectl']
      args: ['wait', '--for=condition=complete', '--timeout=60s', 'jobs/{{ include "schema-loading.fullname" . }}']
  restartPolicy: Never
